<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BONK Coin Advanced Admin Panel</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="database.js"></script> 
    <style>
        :root {
            --primary-color: #6366F1;
            --secondary-color: #8B5CF6; 
            --bg-dark: #0F172A;
            --card-bg: #1E293B;
            --text-light: #F8FAFC;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body>
    <!-- Main Content -->
    <div class="flex">
        <!-- Sidebar -->
        <div class="w-64 p-4 bg-gradient-to-br from-primary-color to-secondary-color min-h-screen">
            <div class="mb-8 text-center">
                <img src="https://raw.githubusercontent.com/bonk-coin/brand-assets/main/bonk-logo.png" alt="BONK Admin" class="w-24 mx-auto mb-4">
                <h1 class="text-2xl font-bold text-white">BONK Admin</h1>
            </div>

            <nav>
                <ul>
                    <li class="mb-2">
                        <a href="#dashboard" class="flex items-center p-3 rounded hover:bg-white/10 transition">
                            <i class="mr-3">üìä</i> Dashboard
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="#users" class="flex items-center p-3 rounded hover:bg-white/10 transition">
                            <i class="mr-3">üë•</i> Users
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="#transactions" class="flex items-center p-3 rounded hover:bg-white/10 transition">
                            <i class="mr-3">üí∞</i> Transactions
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="#games" class="flex items-center p-3 rounded hover:bg-white/10 transition">
                            <i class="mr-3">üéÆ</i> Games
                        </a>
                    </li>
                    <li class="mb-2">
                        <a href="#settings" class="flex items-center p-3 rounded hover:bg-white/10 transition">
                            <i class="mr-3">‚öôÔ∏è</i> Settings
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Content Area -->
        <div class="flex-grow p-6">
            <!-- Dashboard Section -->
            <section id="dashboard" class="mb-8">
                <h2 class="text-2xl font-bold mb-4">Dashboard</h2>

                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- KPI Cards -->
                    <div class="p-4 rounded bg-card-bg shadow">
                        <p class="text-sm text-secondary-color mb-2">Total Users</p>
                        <p class="text-3xl font-bold" id="totalUsers">0</p>
                    </div>

                    <div class="p-4 rounded bg-card-bg shadow">
                        <p class="text-sm text-secondary-color mb-2">Total BONK</p>
                        <p class="text-3xl font-bold" id="totalBonk">0</p>
                    </div>

                    <div class="p-4 rounded bg-card-bg shadow">
                        <p class="text-sm text-secondary-color mb-2">BONK Price</p>
                        <p class="text-3xl font-bold">$<span id="bonkPrice">0.00</span></p>
                    </div>

                    <div class="p-4 rounded bg-card-bg shadow">
                        <p class="text-sm text-secondary-color mb-2">Transactions (24h)</p>
                        <p class="text-3xl font-bold" id="dailyTransactions">0</p>
                    </div>
                </div>

                <!-- User Analytics -->
                <div class="mt-8">
                    <h3 class="text-xl font-bold mb-4">User Analytics</h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- New Users Chart -->
                        <div class="bg-card-bg rounded shadow">
                            <div class="p-4 border-b border-gray-700">
                                <h4 class="font-semibold">New Users</h4>
                            </div>
                            <div class="p-4">
                                <canvas id="newUsersChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- User Activity Chart -->
                        <div class="bg-card-bg rounded shadow">
                            <div class="p-4 border-b border-gray-700">
                                <h4 class="font-semibold">User Activity</h4>
                            </div>
                            <div class="p-4">
                                <canvas id="userActivityChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="mt-8 overflow-auto">
                    <h3 class="text-xl font-bold mb-4">Recent Activity</h3>
                    
                    <table class="w-full">
                        <thead>
                            <tr class="text-sm text-secondary-color border-b border-gray-700">
                                <th class="p-3 text-left">User</th>
                                <th class="p-3 text-left">Activity</th>
                                <th class="p-3 text-left">Time</th>
                            </tr>
                        </thead>
                        <tbody id="recentActivity">
                            <!-- Activity rows will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="mb-8">
                <h2 class="text-2xl font-bold mb-4">Users</h2>

                <!-- User Management Controls -->
                <div class="mb-4">
                    <input type="text" id="userSearch" placeholder="Search users..." class="px-4 py-2 rounded bg-card-bg border border-gray-700 mr-2">
                    <button id="newUserBtn" class="px-4 py-2 rounded bg-primary-color font-semibold">Add User</button>
                </div>

                <!-- User Table -->
                <div class="overflow-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-sm text-secondary-color border-b border-gray-700">
                                <th class="p-3 text-left">ID</th>
                                <th class="p-3 text-left">Name</th>
                                <th class="p-3 text-left">Email</th>
                                <th class="p-3 text-left">Balance</th>
                                <th class="p-3 text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="userList">
                            <!-- User rows will be populated here -->
                        </tbody>
                    </table>
                </div>

                <!-- User Detail Modal -->
                <div id="userModal" class="fixed z-10 inset-0 overflow-y-auto hidden">
                    <div class="flex items-center justify-center min-h-screen">
                        <div class="fixed inset-0 bg-black opacity-50"></div>
                        <div class="bg-card-bg rounded shadow-lg w-11/12 md:w-1/2 z-20">
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-4">User Details</h3>
                                <div id="userDetails">
                                    <!-- User details will be populated here -->
                                </div>
                            </div>
                            <div class="p-4 border-t border-gray-700 text-right">
                                <button id="editUserBtn" class="px-4 py-2 rounded bg-yellow-600 font-semibold mr-2">Edit</button>
                                <button id="deleteUserBtn" class="px-4 py-2 rounded bg-red-600 font-semibold mr-2">Delete</button>
                                <button id="closeUserModalBtn" class="px-4 py-2 rounded bg-gray-600 font-semibold">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Transactions Section -->
            <section id="transactions" class="mb-8">
                <h2 class="text-2xl font-bold mb-4">Transactions</h2>

                <!-- Transaction Filters -->
                <div class="mb-4">
                    <label for="transactionType" class="mr-2">Type:</label>
                    <select id="transactionType" class="px-4 py-2 rounded bg-card-bg border border-gray-700 mr-4">
                        <option value="all">All</option>
                        <option value="deposit">Deposit</option>
                        <option value="withdrawal">Withdrawal</option>
                    </select>

                    <label for="transactionStatus" class="mr-2">Status:</label>
                    <select id="transactionStatus" class="px-4 py-2 rounded bg-card-bg border border-gray-700">
                        <option value="all">All</option>
                        <option value="pending">Pending</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                    </select>
                </div>

                <!-- Transaction Table -->
                <div class="overflow-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="text-sm text-secondary-color border-b border-gray-700">
                                <th class="p-3 text-left">ID</th>
                                <th class="p-3 text-left">User</th>
                                <th class="p-3 text-left">Type</th>
                                <th class="p-3 text-left">Amount</th>
                                <th class="p-3 text-left">Status</th>
                                <th class="p-3 text-left">Date</th>
                                <th class="p-3 text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transactionList">
                            <!-- Transaction rows will be populated here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Games Section -->
            <section id="games" class="mb-8">
                <h2 class="text-2xl font-bold mb-4">Games</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    <!-- Game Cards -->
                    <div class="bg-card-bg rounded shadow p-4">
                        <img src="flappy-preview.png" alt="Flappy BONK" class="w-full h-40 object-cover mb-4">
                        <h4 class="font-semibold mb-2">Flappy BONK</h4>
                        <div class="flex justify-between text-sm">
                            <span>Players: <span id="flappyPlayers">0</span></span>
                            <span>High Score: <span id="flappyHighScore">0</span></span>
                        </div>
                    </div>

                    <div class="bg-card-bg rounded shadow p-4">
                        <img src="clicker-preview.png" alt="BONK Clicker" class="w-full h-40 object-cover mb-4">
                        <h4 class="font-semibold mb-2">BONK Clicker</h4>
                        <div class="flex justify-between text-sm">
                            <span>Players: <span id="clickerPlayers">0</span></span>
                            <span>Clicks: <span id="totalClicks">0</span></span>
                        </div>
                    </div>

                    <div class="bg-card-bg rounded shadow p-4">
                        <img src="dino-preview.png" alt="BONK Dino" class="w-full h-40 object-cover mb-4">
                        <h4 class="font-semibold mb-2">BONK Dino</h4>
                        <div class="flex justify-between text-sm">
                            <span>Players: <span id="dinoPlayers">0</span></span>
                            <span>High Score: <span id="dinoHighScore">0</span></span>
                        </div>
                    </div>

                    <!-- Add more game cards as needed -->
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="mb-8">
                <h2 class="text-2xl font-bold mb-4">Settings</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- System Settings -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4">System</h3>
                        
                        <div class="mb-4">
                            <label for="maintenanceMode" class="flex items-center">
                                <input type="checkbox" id="maintenanceMode" class="form-checkbox h-5 w-5 text-primary-color mr-2">
                                <span class="text-sm">Maintenance Mode</span>
                            </label>
                        </div>

                        <div class="mb-4">
                            <label for="referralBonus" class="block mb-1 text-sm">Referral Bonus (BONK)</label>
                            <input type="number" id="referralBonus" class="w-24 px-2 py-1 rounded bg-card-bg border border-gray-700">
                        </div>

                        <!-- Add more system settings as needed -->
                    </div>

                    <!-- Game Settings -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4">Games</h3>
                        
                        <div class="mb-4">
                            <label for="flappyReward" class="block mb-1 text-sm">Flappy BONK Reward</label>
                            <input type="number" id="flappyReward" class="w-24 px-2 py-1 rounded bg-card-bg border border-gray-700">
                        </div>

                        <div class="mb-4">
                            <label for="clickerReward" class="block mb-1 text-sm">BONK Clicker Reward</label>
                            <input type="number" id="clickerReward" class="w-24 px-2 py-1 rounded bg-card-bg border border-gray-700">
                        </div>

                        <div class="mb-4">
                            <label for="dinoReward" class="block mb-1 text-sm">BONK Dino Reward</label>
                            <input type="number" id="dinoReward" class="w-24 px-2 py-1 rounded bg-card-bg border border-gray-700">
                        </div>

                        <!-- Add more game settings as needed -->
                    </div>
                </div>

                <button id="saveSettingsBtn" class="mt-4 px-4 py-2 rounded bg-primary-color font-semibold">Save Settings</button>
            </section>
        </div>
    </div>

    <script>
        // Data fetching and rendering functions will be added here
        async function fetchData() {
            try {
                const stats = await DATABASE.stats.getGlobalStats();
                
                // Update KPI cards
                document.getElementById('totalUsers').textContent = stats.totalUsers.toLocaleString();
                document.getElementById('totalBonk').textContent = stats.totalBonk.toLocaleString();
                document.getElementById('dailyTransactions').textContent = stats.transactions?.last24Hours?.count || 0;

                // Update user analytics charts
                renderNewUsersChart(stats.newUsersByDay);
                renderUserActivityChart(stats.userActivityByHour);
                
                // Update recent activity
                renderRecentActivity(stats.recentActivity);

                // Update game stats
                document.getElementById('flappyPlayers').textContent = stats.gameStats.flappyBird.totalPlays;
                document.getElementById('flappyHighScore').textContent = stats.gameStats.flappyBird.highScore;
                document.getElementById('clickerPlayers').textContent = stats.gameStats.clicker.activePlayers;
                document.getElementById('totalClicks').textContent = stats.gameStats.clicker.totalClicks;  
                document.getElementById('dinoPlayers').textContent = stats.gameStats.dinoRunner.totalPlays;
                document.getElementById('dinoHighScore').textContent = stats.gameStats.dinoRunner.highScore;
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        // Render charts, tables, etc. based on fetched data
        function renderNewUsersChart(data) {
            // Render new users chart using Chart.js
        }

        function renderUserActivityChart(data) {
            // Render user activity chart using Chart.js  
        }

        function renderRecentActivity(data) {
            // Render recent activity table rows
        }

        // User management functions
        async function fetchUsers() {
            // Fetch user list from database and render table rows
        }

        async function addUser() {
            // Show add user form modal  
        }

        async function viewUser(userId) {
            // Fetch user details and show in modal
        }

        async function editUser(userId) {
            // Show edit user form modal
        }

        async function deleteUser(userId) {
            // Confirm and delete user   
        }

        // Transaction management functions  
        async function fetchTransactions() {
            // Fetch transactions based on filters and render table rows
        }

        // Settings management functions
        async function updateSettings() {
            // Update settings in database 
        }

        // Event listeners
        document.getElementById('newUserBtn').addEventListener('click', addUser);
        document.getElementById('saveSettingsBtn').addEventListener('click', updateSettings);
        // Add more event listeners as needed

        // Initial data load
        fetchData();
        fetchUsers();
        fetchTransactions();
    </script>
</body>
</html>
